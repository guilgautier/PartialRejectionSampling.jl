<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sampling methods · PartialRejectionSampling.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PartialRejectionSampling.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Sampling methods</a><ul class="internal"><li><a class="tocitem" href="#Default-exact-sampler"><span>Default exact sampler</span></a></li><li><a class="tocitem" href="#Partial-Rejection-Sampling-(PRS)"><span>Partial Rejection Sampling (PRS)</span></a></li><li><a class="tocitem" href="#Grid-Partial-Rejection-Sampling-(grid-PRS)"><span>Grid Partial Rejection Sampling (grid PRS)</span></a></li><li><a class="tocitem" href="#Uniform-sampling-in-spatial-windows"><span>Uniform sampling in spatial windows</span></a></li><li><a class="tocitem" href="#Dominated-Coupling-From-The-Past-(dCFTP)"><span>Dominated Coupling From The Past (dCFTP)</span></a></li></ul></li><li><a class="tocitem" href="../graph/">Graph point processes</a></li><li><a class="tocitem" href="../spatial/">Spatial point processes</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Sampling methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sampling methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/master/docs/src/sampling.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Sampling-methods"><a class="docs-heading-anchor" href="#Sampling-methods">Sampling methods</a><a id="Sampling-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-methods" title="Permalink"></a></h1><p>Below is the list of point processes which can be sampled exactly using <code>PartialRejectionSampling.jl</code></p><ul><li><a href="../spatial/#Spatial-point-processes">Spatial point processes</a><ul><li><a href="../spatial/#PartialRejectionSampling.HardCorePointProcess"><code>PRS.HardCorePointProcess</code></a></li><li><a href="../spatial/#PartialRejectionSampling.HomogeneousPoissonPointProcess"><code>PRS.HomogeneousPoissonPointProcess</code></a></li><li><a href="../spatial/#PartialRejectionSampling.StraussPointProcess"><code>PRS.StraussPointProcess</code></a></li></ul></li><li><a href="../graph/#Graph-point-processes">Graph point processes</a><ul><li><a href="../graph/#PartialRejectionSampling.HardCoreGraph"><code>PRS.HardCoreGraph</code></a></li><li><a href="../graph/#PartialRejectionSampling.Ising"><code>PRS.Ising</code></a></li><li><a href="../graph/#PartialRejectionSampling.RootedSpanningForest"><code>PRS.RootedSpanningForest</code></a></li><li><a href="../graph/#PartialRejectionSampling.SinkFreeGraph"><code>PRS.SinkFreeGraph</code></a></li></ul></li><li>Miscellaneous<ul><li><a href="../misc/#PartialRejectionSampling.PatternFreeString"><code>PRS.PatternFreeString</code></a></li></ul></li></ul><h2 id="Default-exact-sampler"><a class="docs-heading-anchor" href="#Default-exact-sampler">Default exact sampler</a><a id="Default-exact-sampler-1"></a><a class="docs-heading-anchor-permalink" href="#Default-exact-sampler" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample" href="#PartialRejectionSampling.generate_sample"><code>PartialRejectionSampling.generate_sample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">generate_sample(
    pp::HomogeneousPoissonPointProcess{Vector{T}};
    win::Union{Nothing,AbstractWindow}=nothing,
    rng=-1
)::Matrix{T} where {T&lt;:Float64}</code></pre><p>Generate an exact sample from <a href="#PartialRejectionSampling.HomogeneousPoissonPointProcess"><code>PRS.HomogeneousPoissonPointProcess</code></a> on window <code>win</code>. Sampled points are stored as columns of the output matrix.</p><p>Default window (<code>win=nothing</code>) is <code>window(pp)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/poisson.jl#L62-L73">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::HardCorePointProcess{T}
    win::Union{Nothing,AbstractWindow}=nothing,
    rng=-1
)::Vector{T} where {T}</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.HardCorePointProcess"><code>PRS.HardCorePointProcess</code></a>.</p><p>Default window (<code>win=nothing</code>) is <code>window(pp)=pp.window</code>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p><p><strong>See also</strong></p><ul><li><a href="../sampling/#PartialRejectionSampling.generate_sample_dcftp-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_dcftp</code></a>,</li><li><a href="../sampling/#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/hard_core.jl#L95-L112">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::StraussPointProcess{T};
    win::Union{Nothing,AbstractWindow}=nothing,
    rng=-1
)::Vector{T} where {T}</code></pre><p>Genererate an exact sample from <a href="#PartialRejectionSampling.StraussPointProcess"><code>PRS.StraussPointProcess</code></a>.</p><p>Default window (<code>win=nothing</code>) is <code>window(pp)=pp.window</code>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_dcftp-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_dcftp</code></a>.</p><p><strong>See also</strong></p><ul><li><a href="../sampling/#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/strauss.jl#L103-L118">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::Ising{T},
    idx::T;
    rng=-1
)::T where {T&lt;:Int}</code></pre><p>Generate an exact sample from the marginal distribution of state <span>$i=$</span> <code>idx</code> of <code>pp</code>.</p><p>More specifically,</p><p class="math-container">\[    x_i
        \sim
        \operatorname{Bernoulli}_{-1, 1}
            (\sigma(h_i)),\]</p><p>where <span>$\sigma$</span> denotes the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid function</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising.jl#L122-L141">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::Ising;
    win::GraphNode,
    rng=-1
)</code></pre><p>Generate an exact sample from the marginal distribution of <code>pp</code> at state indexed by <code>win.idx</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L35-L43">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::HardCoreGraph{T};
    rng=-1
)::Vector{T} where {T}</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.SinkFreeGraph"><code>PRS.SinkFreeGraph</code></a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/hard_core.jl#L70-L79">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::RootedSpanningForest{T};
    rng=-1
)</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.RootedSpanningForest"><code>PRS.RootedSpanningForest</code></a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/rooted_spanning_forest.jl#L70-L79">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pp::SinkFreeGraph;
    rng=-1
)</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.SinkFreeGraph"><code>PRS.SinkFreeGraph</code></a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/sink_free_graph.jl#L40-L49">source</a></section><section><div><pre><code class="language-julia">generate_sample(
    pfs::PatternFreeString{T},
    size::Int;
    rng=-1
)::T where {T&lt;:String}</code></pre><p>Generate a string uniformly at random among all strings made of characters from <code>pfs.alphabet</code> with no occurence of the pattern <code>pfs.pattern</code>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/misc/pattern_free_string.jl#L40-L50">source</a></section></article><h2 id="Partial-Rejection-Sampling-(PRS)"><a class="docs-heading-anchor" href="#Partial-Rejection-Sampling-(PRS)">Partial Rejection Sampling (PRS)</a><a id="Partial-Rejection-Sampling-(PRS)-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-Rejection-Sampling-(PRS)" title="Permalink"></a></h2><p><a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a> developed the PRS methodology to generate exact samples from product distributions of the form <span>$\otimes_{n=1}^{N} \mu_n$</span> subject to some constraints. It requires access to an exact sampler for each <span>$\mu_n$</span> and an oracle to check the violation of the constraints.</p><p>Given an initial sample from <span>$\otimes_{n=1}^{N} \mu_n$</span>:</p><ul><li><a href="https://en.wikipedia.org/wiki/Rejection_sampling">Vanilla rejection sampling</a> resample all variables if any constraint is violated; until all constraints are satisfied,</li><li>Partial rejection sampling instead constructs a subset of variables to be resampled, starting from variables involved in violated constraints, and preserves the state of the variables outside of this resampling set; until all constraints are satisfied.</li></ul><p>In both cases, the output sample is guaranteed to have the right distribution, i.e., the product distribution subject to the prescribed constraints.</p><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_prs" href="#PartialRejectionSampling.generate_sample_prs"><code>PartialRejectionSampling.generate_sample_prs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">generate_sample_prs(
    pp::HardCorePointProcess{T}
    win::Union{Nothing,AbstractWindow}=nothing,
    rng=-1
)::Vector{T} where {T}</code></pre><p>Sample from <a href="#PartialRejectionSampling.HardCorePointProcess"><code>PRS.HardCorePointProcess</code></a> using Partial Rejection Sampling (PRS) of <a href="../references/#GuJe18">Heng Guo , Mark Jerrum  (2018)</a>.</p><p>Default window (<code>win=nothing</code>) is <code>window(pp)=pp.window</code>.</p><p><strong>See also</strong></p><ul><li><a href="../sampling/#PartialRejectionSampling.generate_sample_dcftp-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_dcftp</code></a></li><li><a href="../sampling/#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</li></ul><p><strong>Example</strong></p><p>A illustration of the procedure for <span>$\beta=38$</span> and <span>$r=0.1$</span> on <span>$[0, 1]^2$</span> where points are marked with a circle of radius <span>$r/2$</span>.</p><p><img src="../assets/hard_core_spatial_prs.gif" alt="assets/hard_core_spatial_prs.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/hard_core.jl#L166-L187">source</a></section><section><div><pre><code class="language-julia">generate_sample_prs(
    pp::StraussPointProcess{T};
    win::Union{Nothing,AbstractWindow}=nothing,
    rng=-1
)::Vector{T} where {T}</code></pre><p>Genererate an exact sample from <a href="#PartialRejectionSampling.StraussPointProcess"><code>PRS.StraussPointProcess</code></a> using Partial Rejection Sampling (PRS).</p><p>Default window (<code>win=nothing</code>) is <code>window(pp)=pp.window</code>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/strauss.jl#L182-L194">source</a></section><section><div><pre><code class="language-julia">generate_sample_prs(pp::Ising; rng=-1)</code></pre><p>Generate an exact sample form <code>pp</code> using Partial Rejection Sampling (PRS), see Section 4.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p><p><strong>See also</strong></p><ul><li><a href="../references/#FeViYi19">Weiming Feng , Nisheeth K. Vishnoi , Yitong Yin  (2019)</a>,</li><li><a href="../references/#FeGuYi19">Weiming Feng , Heng Guo , Yitong Yin  (2019)</a> <a href="#PartialRejectionSampling.generate_sample_gibbs_perfect-Union{Tuple{Ising{T}}, Tuple{T}} where T&lt;:Int64"><code>PRS.generate_sample_gibbs_perfect</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising.jl#L108-L119">source</a></section><section><div><pre><code class="language-julia">generate_sample_prs(
    pp::HardCoreGraph{T};
    rng=-1
)::Vector{T} where {T}</code></pre><p>Sample from <a href="#PartialRejectionSampling.HardCoreGraph"><code>PRS.HardCoreGraph</code></a> using Partial Rejection Sampling (PRS), see Section 7.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a></p><p><strong>See also</strong></p><ul><li>Example 4.1 of <a href="../references/#MoKr20">MoKr20</a>.</li></ul><p><strong>Example</strong></p><p>An illustration of the procedure on a <span>$5\times 5$</span> grid graph.</p><ul><li>red: variables involved in constraints violation (gray neighboring nodes)</li><li>orange: variables to be resampled (red nodes and their neighborhood)</li></ul><p><img src="../assets/hard_core_graph.gif" alt="assets/hard_core_graph.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/hard_core.jl#L89-L109">source</a></section><section><div><pre><code class="language-julia">generate_sample_prs(
    pp::RootedSpanningForest{T};
    rng=-1
)::T where {T&lt;:LG.SimpleDiGraph{Int64}}</code></pre><p>Generate a rooted spanning forest of <code>pp.graph</code>, uniformly at random among all rooted spanning forests rooted at <code>pp.roots</code>, using Partial Rejection Sampling (PRS), see Section 4.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</p><p><strong>Example</strong></p><p>An illustration of the procedure on a <span>$5\times 5$</span> grid graph, with <code>roots=[13]</code></p><ul><li>red: variables involved in constraints violation (edges forming a cycle)</li><li>orange: variables resampled (edges originating from a red/orange node)</li></ul><p><img src="../assets/rooted_spanning_tree_prs.gif" alt="assets/rooted_spanning_tree_prs.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/rooted_spanning_forest.jl#L82-L98">source</a></section><section><div><pre><code class="language-julia">generate_sample_prs(
    pp::SinkFreeGraph{T};
    rng=-1
)::T where {T}</code></pre><p>Generate an orientated version of <code>pp.graph</code> uniformly at random among all possible orientations conditioned on the absence of sinks, using Partial Rejection Sampling (PRS).</p><p><strong>See also</strong></p><ul><li>Section 4.1 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</li></ul><p><strong>Example</strong></p><p>A illustration of the procedure on a <span>$5 \times 5$</span> grid grah.</p><ul><li>red: variables involved in constraints violation (orientation of the edges pointing to a sink node)</li><li>orange: variables resampled (orientation of the previous edges)</li></ul><p><img src="../assets/sink_free_graph_prs.gif" alt="assets/sink_free_graph_prs.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/sink_free_graph.jl#L57-L77">source</a></section><section><div><pre><code class="language-julia">generate_sample_prs(
    pfs::PatternFreeString{T},
    size::Int;
    rng=-1
)::T where {T&lt;:String}</code></pre><p>Generate a string uniformly at random among all strings made of characters from <code>pfs.alphabet</code> with no occurence of the pattern <code>pfs.pattern</code>, using a tailored version of Partial Rejection Sampling (PRS) derived by <a href="../references/#GiAmWe18">Juan Gil , Joshua Amaniampong , Jake Wellens  (2018)</a>.</p><pre><code class="language-julia">using PartialRejectionSampling
pfs = PRS.PatternFreeString([&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;], &quot;ATGTA&quot;)
PRS.generate_sample_prs(pfs, 20; rng=1)
# output
&quot;TCCAAATCTCCCCTGTCTAT&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/misc/pattern_free_string.jl#L59-L75">source</a></section></article><h2 id="Grid-Partial-Rejection-Sampling-(grid-PRS)"><a class="docs-heading-anchor" href="#Grid-Partial-Rejection-Sampling-(grid-PRS)">Grid Partial Rejection Sampling (grid PRS)</a><a id="Grid-Partial-Rejection-Sampling-(grid-PRS)-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-Partial-Rejection-Sampling-(grid-PRS)" title="Permalink"></a></h2><p><a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a> adapted the idea of <a href="#Partial-Rejection-Sampling-(PRS)">Partial Rejection Sampling (PRS)</a> (originally derived in the finite setting) to generate exact samples from <a href="../spatial/#Spatial-point-processes">Spatial point processes</a> with finite range of interaction, noted <span>$r &gt; 0$</span>.</p><p>The name of the method <em>grid</em> PRS results from the combination of the <a href="#Partial-Rejection-Sampling-(PRS)">Partial Rejection Sampling (PRS)</a> methodology with a partitioning of the domain of <span>$\mathbb{R}^2$</span> where the target <a href="../spatial/#PartialRejectionSampling.AbstractSpatialPointProcess"><code>PRS.AbstractSpatialPointProcess</code></a> – is divided into <span>$N$</span> cells of type <a href="#PartialRejectionSampling.SpatialCellGridPRS"><code>PRS.SpatialCellGridPRS</code></a> with size <span>$r \times r$</span>,</p><p>To draw the correspondence with framework of PRS developed by <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>, <span>$\mu_n$</span> represents the target <a href="../spatial/#PartialRejectionSampling.AbstractSpatialPointProcess"><code>PRS.AbstractSpatialPointProcess</code></a> restricted to the <span>$n$</span>-th cell, i.e., variables are point configurations.</p><p><strong>Note</strong> that the grid PRS methodology requires an efficient sampling algorithm to generate exact samples on each cell involved in the partitioning of original domain, see, e.g., <a href="#PartialRejectionSampling.generate_sample_dcftp-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_dcftp</code></a> and <a href="#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p><p><strong>See also</strong> closely related variants of grid PRS for</p><ul><li>Spatial point processes<ul><li><a href="../references/#Hub20">Mark Huber  (2020)</a></li></ul></li><li>Graphical models<ul><li><a href="../graph/#Ising-model">Ising model</a></li><li><a href="../references/#FeViYi19">Weiming Feng , Nisheeth K. Vishnoi , Yitong Yin  (2019)</a>, <a href="../references/#FeGuYi19">Weiming Feng , Heng Guo , Yitong Yin  (2019)</a></li></ul></li></ul><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.AbstractCellGridPRS" href="#PartialRejectionSampling.AbstractCellGridPRS"><code>PartialRejectionSampling.AbstractCellGridPRS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractCellGridPRS</code></pre><p>Abstract type describing a cell used Grid Partial Rejection Sampling of <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L5-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.GraphCellGridPRS" href="#PartialRejectionSampling.GraphCellGridPRS"><code>PartialRejectionSampling.GraphCellGridPRS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">GraphCellGridPRS{T} &lt;: AbstractCellGridPRS</code></pre><p>Mutable struct describing a graph node with fields</p><ul><li><code>window</code> of type <a href="../graph/#PartialRejectionSampling.GraphNode"><code>PRS.GraphNode</code></a><code>{T}</code></li><li><code>value</code> of type <code>T</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L12-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.SpatialCellGridPRS" href="#PartialRejectionSampling.SpatialCellGridPRS"><code>PartialRejectionSampling.SpatialCellGridPRS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SpatialCellGridPRS{T&lt;:Vector{Float64}} &lt;: AbstractCellGridPRS</code></pre><p>Mutable struct describing a spatial cell with fields</p><ul><li><code>window</code> of type <code>Union{</code><a href="../spatial/#PartialRejectionSampling.RectangleWindow"><code>PRS.RectangleWindow</code></a><code>,</code><a href="../spatial/#PartialRejectionSampling.RectangleWindow"><code>PRS.RectangleWindow</code></a><code>}</code></li><li><code>value</code> of type <code>Vector{T}</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L25-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.isempty-Tuple{PartialRejectionSampling.SpatialCellGridPRS}" href="#Base.isempty-Tuple{PartialRejectionSampling.SpatialCellGridPRS}"><code>Base.isempty</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Base.isempty(cell::SpatialCellGridPRS) = isempty(cell.value)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L53-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.iterate" href="#Base.iterate"><code>Base.iterate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Base.iterate(cell::AbstractCellGridPRS, state=1) = iterate(cell.value, state)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L48-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.dimension-Tuple{PartialRejectionSampling.AbstractCellGridPRS}" href="#PartialRejectionSampling.dimension-Tuple{PartialRejectionSampling.AbstractCellGridPRS}"><code>PartialRejectionSampling.dimension</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dimension(cell::AbstractCellGridPRS) = dimension(window(cell))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L43-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.find_bad_cells_indices!-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{SimpleWeightedGraphs.SimpleWeightedGraph{T,U},Array{V,1},AbstractPointProcess}} where V&lt;:PartialRejectionSampling.AbstractCellGridPRS where U where T" href="#PartialRejectionSampling.find_bad_cells_indices!-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{SimpleWeightedGraphs.SimpleWeightedGraph{T,U},Array{V,1},AbstractPointProcess}} where V&lt;:PartialRejectionSampling.AbstractCellGridPRS where U where T"><code>PartialRejectionSampling.find_bad_cells_indices!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">find_bad_cells_indices!(
    g::SWG.SimpleWeightedGraph{T,U},
    cells::Vector{V},
    pp::AbstractPointProcess;
    rng=-1
)::Set{T} where {T,U,V&lt;:AbstractCellGridPRS}</code></pre><p>Identify bad events and return the corresponding cells&#39; index. An event <span>$\{i,j\}$</span> is said to be &quot;bad&quot;</p><p class="math-container">\[    \left\{U_{ij} &gt; \exp \left[ -\sum_{x \in C_i} \sum_{y \in C_j} V(x,y) \right] \right\}\]</p><p>where <span>$U_{ij}$</span> is the weight of the edge <span>$\{i,j\}$</span> in the interaction graph <span>$g$</span> created by <a href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}"><code>PRS.weighted_interaction_graph</code></a> and <span>$V$</span> the Gibbs potential discribing the pairwise Gibbs interaction of <code>pp</code></p><p><strong>Note</strong> when a bad event occurs, the corresponding <span>$U_{ij}$</span> is resampled hence the &quot;!&quot;</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L136-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.find_cells_to_resample_indices!-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{SimpleWeightedGraphs.SimpleWeightedGraph{T,U},Array{V,1},AbstractPointProcess}} where V&lt;:PartialRejectionSampling.AbstractCellGridPRS where U where T" href="#PartialRejectionSampling.find_cells_to_resample_indices!-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{SimpleWeightedGraphs.SimpleWeightedGraph{T,U},Array{V,1},AbstractPointProcess}} where V&lt;:PartialRejectionSampling.AbstractCellGridPRS where U where T"><code>PartialRejectionSampling.find_cells_to_resample_indices!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">find_cells_to_resample_indices!(
    g::SWG.SimpleWeightedGraph{T,U},
    cells::Vector{V},
    pp::AbstractPointProcess;
    rng=-1
)::Set{T} where {T,U,V&lt;:AbstractCellGridPRS}</code></pre><p>Identify the set of events to be resampled as constructed by Algorithm 5 in <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a> as part of the Partial Rejection Sampling (PRS) method. Return the indices of the variables (here cells) involved in the corresponding events.</p><p>This function is used as a subroutine of the grid PRS methodology of <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a>, see <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p><p><strong>Note</strong> if the event associated to the edge <span>$\{i,j\}$</span> of <code>g</code> is selected to be resampled, the uniform random variable encoded as the weight of the correspond edge is resampled (hence the &quot;!&quot;)</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L176-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample!-Tuple{PartialRejectionSampling.AbstractCellGridPRS,AbstractPointProcess}" href="#PartialRejectionSampling.generate_sample!-Tuple{PartialRejectionSampling.AbstractCellGridPRS,AbstractPointProcess}"><code>PartialRejectionSampling.generate_sample!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample!(
    cell::AbstractCellGridPRS,
    pp::AbstractPointProcess;
    rng=-1
)</code></pre><p>Generate an exact sample of <code>pp</code> in <code>cell.window</code> and save it in <code>cell.value</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L58-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample!-Union{Tuple{T}, Tuple{Array{T,1},Any,AbstractPointProcess}} where T&lt;:PartialRejectionSampling.AbstractCellGridPRS" href="#PartialRejectionSampling.generate_sample!-Union{Tuple{T}, Tuple{Array{T,1},Any,AbstractPointProcess}} where T&lt;:PartialRejectionSampling.AbstractCellGridPRS"><code>PartialRejectionSampling.generate_sample!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample!(
    cells::Vector{T},
    indices,
    pp::AbstractPointProcess;
    rng=-1
) where {T&lt;:AbstractCellGridPRS}</code></pre><p>Apply <a href="../graph/#PartialRejectionSampling.generate_sample!-Union{Tuple{T}, Tuple{AbstractArray{T,1},Any,Ising{T}}} where T&lt;:Int64"><code>PRS.generate_sample!</code></a> to each cell of <code>cells</code> indexed by <code>indices</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L76-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample-Tuple{Ising}" href="#PartialRejectionSampling.generate_sample-Tuple{Ising}"><code>PartialRejectionSampling.generate_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample(
    pp::Ising;
    win::GraphNode,
    rng=-1
)</code></pre><p>Generate an exact sample from the marginal distribution of <code>pp</code> at state indexed by <code>win.idx</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L35-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T" href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PartialRejectionSampling.generate_sample_grid_prs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_grid_prs(
    pp::AbstractPointProcess{T};
    rng=-1
)::Vector{T} where {T}</code></pre><p>Generate an exact sample from <code>pp</code> using grid Partial Rejection Sampling (grid PRS) of <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L98-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.gibbs_interaction" href="#PartialRejectionSampling.gibbs_interaction"><code>PartialRejectionSampling.gibbs_interaction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">gibbs_interaction(
    pp::AbstractPointProcess{T},
    cell1::AbstractCellGridPRS{T},
    cell2::AbstractCellGridPRS{T}
)::Real where {T}</code></pre><p>Compute the pairwise Gibbs interaction <code>pp</code> between <span>$C_1$</span>=<code>cell1</code> and <span>$C_2$</span>=<code>cell2</code>.</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L123-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.gibbs_interaction-Union{Tuple{T}, Tuple{Ising{T},PartialRejectionSampling.GraphCellGridPRS{T},PartialRejectionSampling.GraphCellGridPRS{T}}} where T" href="#PartialRejectionSampling.gibbs_interaction-Union{Tuple{T}, Tuple{Ising{T},PartialRejectionSampling.GraphCellGridPRS{T},PartialRejectionSampling.GraphCellGridPRS{T}}} where T"><code>PartialRejectionSampling.gibbs_interaction</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gibbs_interaction(
    ising::Ising{T},
    xᵢ::GraphCellGridPRS{T},
    xⱼ::GraphCellGridPRS{T}
)::Real where {T}</code></pre><p>Compute the Gibbs interaction of <a href="../graph/#PartialRejectionSampling.Ising"><code>PRS.Ising</code></a></p><p class="math-container">\[    \exp(J x_i x_j - |J|)).\]</p><p><strong>Note</strong> the Gibbs interaction is normalized in be in [0, 1] to fit the framework of <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a> and <a href="../references/#FeViYi19">Weiming Feng , Nisheeth K. Vishnoi , Yitong Yin  (2019)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L52-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.initialize_cells-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T" href="#PartialRejectionSampling.initialize_cells-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T"><code>PartialRejectionSampling.initialize_cells</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">initialize_cells(
    spp::AbstractSpatialPointProcess{T},
)::Vector{SpatialCellGridPRS{T}} where {T}</code></pre><p>The <code>spp.window</code> (<a href="../spatial/#PartialRejectionSampling.RectangleWindow"><code>PRS.RectangleWindow</code></a> or <a href="../spatial/#PartialRejectionSampling.SquareWindow"><code>PRS.SquareWindow</code></a>) is divided into <a href="#PartialRejectionSampling.SpatialCellGridPRS"><code>PRS.SpatialCellGridPRS</code></a> of length the interaction range <code>pp.r</code> following the construction of <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a> in their grid Partial Rejection Sampling (grid PRS) methodology.</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L253-L261">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.initialize_cells-Union{Tuple{Ising{T}}, Tuple{T}} where T" href="#PartialRejectionSampling.initialize_cells-Union{Tuple{Ising{T}}, Tuple{T}} where T"><code>PartialRejectionSampling.initialize_cells</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">initialize_cells(
    ising::Ising{T}
)::Vector{GraphCellGridPRS{T}} where {T}</code></pre><p>Each node of <code>ising.graph</code> is considered as a <code>cell</code> of type <a href="#PartialRejectionSampling.GraphCellGridPRS"><code>PRS.GraphCellGridPRS</code></a> such that <code>cell.window</code> is a <a href="../graph/#PartialRejectionSampling.GraphNode"><code>PRS.GraphNode</code></a> and <code>cell.value</code> initialized to <code>zero(T)</code>.</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L20-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.is_inner_interaction_possible-Tuple{AbstractSpatialPointProcess,PartialRejectionSampling.SpatialCellGridPRS,PartialRejectionSampling.SpatialCellGridPRS}" href="#PartialRejectionSampling.is_inner_interaction_possible-Tuple{AbstractSpatialPointProcess,PartialRejectionSampling.SpatialCellGridPRS,PartialRejectionSampling.SpatialCellGridPRS}"><code>PartialRejectionSampling.is_inner_interaction_possible</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">is_inner_interaction_possible(
    spp::AbstractSpatialPointProcess,
    cell_i::SpatialCellGridPRS,
    cell_j::SpatialCellGridPRS
) = false</code></pre><p>Assume <code>cell_i</code> and <code>cell_j</code> are neighboring cells in the weighted interaction graph constructed by <a href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}"><code>PRS.weighted_interaction_graph</code></a> from <code>spp</code> and already identified in the set of variables to be resampled in <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a> Since the configuration of points in the corresponding cells and the uniform random variable associated to the event <code>\{i,j\}</code> are considered fixed, there is no degree of freedom to make the interaction between <code>cell_i</code> and <code>cell_j</code> possible.</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L284-L295">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.is_inner_interaction_possible-Union{Tuple{T}, Tuple{Ising{T},PartialRejectionSampling.GraphCellGridPRS{T},PartialRejectionSampling.GraphCellGridPRS{T}}} where T" href="#PartialRejectionSampling.is_inner_interaction_possible-Union{Tuple{T}, Tuple{Ising{T},PartialRejectionSampling.GraphCellGridPRS{T},PartialRejectionSampling.GraphCellGridPRS{T}}} where T"><code>PartialRejectionSampling.is_inner_interaction_possible</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">is_inner_interaction_possible(
    ising::Ising{T},
    xᵢ::GraphCellGridPRS{T},
    xⱼ::GraphCellGridPRS{T}
) = true</code></pre><p>Assume <code>xᵢ</code> and <code>xⱼ</code> are neighboring sites in the weighted interaction graph constructed by <a href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}"><code>PRS.weighted_interaction_graph</code></a> from <code>ising.graph</code> and already identified in the set of variables to be resampled <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>. Given the states of <code>xᵢ</code> and <code>xⱼ</code>, check whether a new assigment of <span>$U_{ij}$</span> (the weight of edge <span>$\{i,j\}$</span>) can induce the bad event</p><p class="math-container">\[    U_{ij} &gt; \exp(J x_i x_j - |J|))\]</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L75-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.is_outer_interaction_possible-Tuple{AbstractSpatialPointProcess,PartialRejectionSampling.SpatialCellGridPRS,PartialRejectionSampling.SpatialCellGridPRS}" href="#PartialRejectionSampling.is_outer_interaction_possible-Tuple{AbstractSpatialPointProcess,PartialRejectionSampling.SpatialCellGridPRS,PartialRejectionSampling.SpatialCellGridPRS}"><code>PartialRejectionSampling.is_outer_interaction_possible</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">is_outer_interaction_possible(
    spp::AbstractSpatialPointProcess,
    cell_i::SpatialCellGridPRS,
    cell_j::SpatialCellGridPRS
)::Bool</code></pre><p>Assume <code>cell_i</code> and <code>cell_j</code> are neighboring cells in the weighted interaction graph constructed by <a href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}"><code>PRS.weighted_interaction_graph</code></a> from <code>spp</code>. Given the configuration of points in <code>cell_i</code>, check whether a realization of <code>spp</code> in <code>cell_j</code> can induce a bad event.</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L304-L315">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.is_outer_interaction_possible-Union{Tuple{T}, Tuple{Ising{T},PartialRejectionSampling.GraphCellGridPRS{T},PartialRejectionSampling.GraphCellGridPRS{T}}} where T" href="#PartialRejectionSampling.is_outer_interaction_possible-Union{Tuple{T}, Tuple{Ising{T},PartialRejectionSampling.GraphCellGridPRS{T},PartialRejectionSampling.GraphCellGridPRS{T}}} where T"><code>PartialRejectionSampling.is_outer_interaction_possible</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">is_outer_interaction_possible(
    ising::Ising{T},
    xᵢ::GraphCellGridPRS{T},
    xⱼ::GraphCellGridPRS{T}
) = true</code></pre><p>Assume <code>xᵢ</code> and <code>xⱼ</code> are neighboring sites in the weighted interaction graph constructed by <a href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}"><code>PRS.weighted_interaction_graph</code></a> from <code>ising.graph</code>. Given the state of <code>xᵢ</code>, one can always find a new assigment of <code>xⱼ</code> and/or <span>$U_{ij}$</span> (the weight of edge <span>$\{i,j\}$</span>) can induce the bad event</p><p class="math-container">\[    U_{ij} &gt; \exp(J x_i x_j - |J|))\]</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L99-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}" href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{AbstractSpatialPointProcess}"><code>PartialRejectionSampling.weighted_interaction_graph</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">weighted_interaction_graph(
    pp::AbstractSpatialPointProcess;
    rng=-1
)::SWG.SimpleWeightedGraph</code></pre><p>Construct the weighted interaction graph (<a href="https://en.wikipedia.org/wiki/King%27s_graph">King graph</a>) used in <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>, to generate exact samples from <a href="../spatial/#PartialRejectionSampling.AbstractSpatialPointProcess"><code>PRS.AbstractSpatialPointProcess</code></a></p><p>The <code>pp.window</code> is divided into cells of length the interaction range <code>pp.r</code>. Each cell represents a vertex of the interaction (king) graph and each edge carries a uniform random varialble.</p><p><strong>See also</strong></p><ul><li>Figure 4 <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L224-L238">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.weighted_interaction_graph-Tuple{Ising}" href="#PartialRejectionSampling.weighted_interaction_graph-Tuple{Ising}"><code>PartialRejectionSampling.weighted_interaction_graph</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">weighted_interaction_graph(
    ising::Ising;
    rng=-1
)::SWG.SimpleWeightedGraph</code></pre><p>Return a weighted version of <code>ising.graph</code> where each edge is attached an independent uniform random variable.</p><p>This is a subroutine of <a href="#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{AbstractPointProcess{T}}, Tuple{T}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/graph/ising_sampling_grid_prs.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.window-Tuple{PartialRejectionSampling.AbstractCellGridPRS}" href="#PartialRejectionSampling.window-Tuple{PartialRejectionSampling.AbstractCellGridPRS}"><code>PartialRejectionSampling.window</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">window(cell::AbstractCellGridPRS) = cell.window</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/grid_prs.jl#L38-L40">source</a></section></article><h2 id="Uniform-sampling-in-spatial-windows"><a class="docs-heading-anchor" href="#Uniform-sampling-in-spatial-windows">Uniform sampling in spatial windows</a><a id="Uniform-sampling-in-spatial-windows-1"></a><a class="docs-heading-anchor-permalink" href="#Uniform-sampling-in-spatial-windows" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Base.rand" href="#Base.rand"><code>Base.rand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Base.rand(
    win::AbstractRectangleWindow{T};
    rng=-1
)::Vector{T} where {T}</code></pre><p>Sample uniformly at random in window <code>win</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/window.jl#L177-L184">source</a></section><section><div><pre><code class="language-julia">Base.rand(
    win::AbstractRectangleWindow{T},
    n::Int;
    rng=-1
)::Matrix{T} where {T}</code></pre><p>Sample <code>n</code> points uniformly at random in window <code>win</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/window.jl#L193-L201">source</a></section><section><div><pre><code class="language-julia">Base.rand(
    win::BallWindow{T};
    rng=-1
)::Vector{T} where {T}</code></pre><p>Sample uniformly at random in window <code>win</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/window.jl#L213-L220">source</a></section><section><div><pre><code class="language-julia">Base.rand(
    win::BallWindow{T},
    n::Int;
    rng=-1
)::Matrix{T} where {T}</code></pre><p>Sample <code>n</code> points uniformly at random in window <code>win</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/window.jl#L233-L241">source</a></section></article><h2 id="Dominated-Coupling-From-The-Past-(dCFTP)"><a class="docs-heading-anchor" href="#Dominated-Coupling-From-The-Past-(dCFTP)">Dominated Coupling From The Past (dCFTP)</a><a id="Dominated-Coupling-From-The-Past-(dCFTP)-1"></a><a class="docs-heading-anchor-permalink" href="#Dominated-Coupling-From-The-Past-(dCFTP)" title="Permalink"></a></h2><p>Implementation of dominated Coupling From The Past (dCFTP) developed by <a href="../references/#KeMo99">Wilfrid Stephen Kendall , Jesper Møller  (1999)</a> and <a href="../references/#KeMo00">Wilfrid Stephen Kendall , Jesper Møller  (2000)</a></p><p><strong>See also</strong></p><ul><li><a href="../references/#Hub16">Mark L Huber  (2016)</a></li><li><a href="&lt;https:/warwick.ac.uk/fac/sci/statistics/staff/&gt;  academic-research/kendall/personal/ppt/428.pdf">Kendall&#39;s notes on perfect simulation</a></li></ul><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.backward_extend!-Union{Tuple{T}, Tuple{Set{T},Array{Float64,1},Array{T,1},StepRange,Real,AbstractWindow}} where T" href="#PartialRejectionSampling.backward_extend!-Union{Tuple{T}, Tuple{Set{T},Array{Float64,1},Array{T,1},StepRange,Real,AbstractWindow}} where T"><code>PartialRejectionSampling.backward_extend!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">backward_extend!(
    D::Set{T},          # Dominating process
    M::Vector{Float64}, # Marking process
    R::Vector{T},       # Recording process
    steps::StepRange,   # Number of backward steps
    birth_rate::Real,
    win::AbstractWindow;
    rng=-1
) where {T}</code></pre><p>Sample from the dominating birth-death process backwards in time according to <code>steps</code>. The marks <code>M</code> and the points <code>R</code> which were added (uniform mark) / deleted (mark=0) along the run are recorded (<code>pushfirst!</code>). The final state of the dominating process is updated to <code>D</code>.</p><p><strong>See also</strong></p><ul><li><code>SBDevolve()</code> <a href="../references/#KeMo99">Wilfrid Stephen Kendall , Jesper Møller  (1999)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L95-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.forward_coupling-Union{Tuple{T}, Tuple{Set{T},Array{Float64,1},Array{T,1},AbstractSpatialPointProcess{T},Real}} where T" href="#PartialRejectionSampling.forward_coupling-Union{Tuple{T}, Tuple{Set{T},Array{Float64,1},Array{T,1},AbstractSpatialPointProcess{T},Real}} where T"><code>PartialRejectionSampling.forward_coupling</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">forward_coupling(
    D::Set{T},           # Dominating process
    M::Vector{Float64},  # Marking process
    R::Vector{T},        # Recording process
    pp::AbstractSpatialPointProcess{T},
    β::Real              # Upper bound on papangelou conditional intensity
) where {T}</code></pre><p>Check if coalescence occured between the lower and upper bounding processes and return the state of the lower bounding process at time 0.</p><p><strong>See also</strong></p><ul><li><code>SBDadd()</code> <a href="../references/#KeMo99">Wilfrid Stephen Kendall , Jesper Møller  (1999)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L142-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_dcftp-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T" href="#PartialRejectionSampling.generate_sample_dcftp-Union{Tuple{AbstractSpatialPointProcess{T}}, Tuple{T}} where T"><code>PartialRejectionSampling.generate_sample_dcftp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_dcftp(
    pp::AbstractSpatialPointProcess{T};
    win::Union{Nothing,AbstractWindow}=nothing,
    n₀::Int=1,
    rng=-1
)::Vector{T} where {T}</code></pre><p>Generate an exact sample from a spatial point process <code>pp</code> on window <code>win</code> using dominated coupling from the past.</p><ul><li>Default window (<code>win=nothing</code>) is <code>window(pp)=pp.window</code></li><li>Initial coalescence check performed after <code>n₀</code> steps.</li><li>Seed or random number generator is passed via <code>rng</code>.</li></ul><p><strong>See also</strong></p><ul><li><a href="../references/#KeMo99">Wilfrid Stephen Kendall , Jesper Møller  (1999)</a>, <a href="../references/#KeMo00">Wilfrid Stephen Kendall , Jesper Møller  (2000)</a></li><li>Section 11.2.6 <a href="../references/#MoWa04">Jesper. Møller , Rasmus Plenge. Waagepetersen  (2004)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L46-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.isattractive-Tuple{AbstractSpatialPointProcess}" href="#PartialRejectionSampling.isattractive-Tuple{AbstractSpatialPointProcess}"><code>PartialRejectionSampling.isattractive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">isattractive(pp::AbstractSpatialPointProcess)</code></pre><p>Property of a <a href="../spatial/#PartialRejectionSampling.AbstractSpatialPointProcess"><code>PRS.AbstractSpatialPointProcess</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.isrepulsive-Tuple{AbstractSpatialPointProcess}" href="#PartialRejectionSampling.isrepulsive-Tuple{AbstractSpatialPointProcess}"><code>PartialRejectionSampling.isrepulsive</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">isrepulsive(pp::AbstractSpatialPointProcess)</code></pre><p>Property of a <a href="../spatial/#PartialRejectionSampling.AbstractSpatialPointProcess"><code>PRS.AbstractSpatialPointProcess</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.papangelou_conditional_intensity-Tuple{AbstractSpatialPointProcess,Any,Any}" href="#PartialRejectionSampling.papangelou_conditional_intensity-Tuple{AbstractSpatialPointProcess,Any,Any}"><code>PartialRejectionSampling.papangelou_conditional_intensity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">papangelou_conditional_intensity(pp::AbstractSpatialPointProcess, x, X)</code></pre><p>Compute the <a href="https://en.wikipedia.org/wiki/Point_process#Papangelou_intensity_function">Papangelou conditional intensity</a> of <code>pp</code>, as the ratio of densities <span>$\frac{f(X \cup x)}{f(X)}$</span>.</p><p><strong>See also</strong></p><ul><li>Section 6.1.1 <a href="../references/#MoWa04">Jesper. Møller , Rasmus Plenge. Waagepetersen  (2004)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L10-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.upper_bound_papangelou_conditional_intensity-Tuple{AbstractSpatialPointProcess}" href="#PartialRejectionSampling.upper_bound_papangelou_conditional_intensity-Tuple{AbstractSpatialPointProcess}"><code>PartialRejectionSampling.upper_bound_papangelou_conditional_intensity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">upper_bound_papangelou_conditional_intensity(pp::AbstractSpatialPointProcess)</code></pre><p>Compute an upper bound on the <a href="#PartialRejectionSampling.papangelou_conditional_intensity-Tuple{AbstractSpatialPointProcess,Any,Any}"><code>PRS.papangelou_conditional_intensity</code></a> of <code>pp</code></p><p><strong>See also</strong></p><ul><li>Equation 2.1 <a href="../references/#KeMo99">Wilfrid Stephen Kendall , Jesper Møller  (1999)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/1cf18fe9d8f6fd8181c51ae025755ce12cd38fc8/src/spatial/dominated_cftp.jl#L21-L29">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../graph/">Graph point processes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 25 February 2021 11:04">Thursday 25 February 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
