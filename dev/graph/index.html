<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Graph point processes · PartialRejectionSampling.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PartialRejectionSampling.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../sampling/">Sampling methods</a></li><li class="is-active"><a class="tocitem" href>Graph point processes</a><ul class="internal"><li><a class="tocitem" href="#Hard-core-graph"><span>Hard core graph</span></a></li><li><a class="tocitem" href="#Rooted-spanning-forests"><span>Rooted spanning forests</span></a></li><li><a class="tocitem" href="#Sink-free-graph"><span>Sink free graph</span></a></li><li><a class="tocitem" href="#Ising-model"><span>Ising model</span></a></li></ul></li><li><a class="tocitem" href="../spatial/">Spatial point processes</a></li><li><a class="tocitem" href="../misc/">Miscellaneous</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Graph point processes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Graph point processes</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/master/docs/src/graph.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Graph-point-processes"><a class="docs-heading-anchor" href="#Graph-point-processes">Graph point processes</a><a id="Graph-point-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-point-processes" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.AbstractGraphPointProcess" href="#PartialRejectionSampling.AbstractGraphPointProcess"><code>PartialRejectionSampling.AbstractGraphPointProcess</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractGraphPointProcess{T&lt;:Vector{Float64}} &lt;: AbstractPointProcess{T}</code></pre><p>Abstract type encoding point processes defined on graphs</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/common.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.GraphNode" href="#PartialRejectionSampling.GraphNode"><code>PartialRejectionSampling.GraphNode</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">GraphNode{T&lt;:Int64} &lt;: AbstractDiscreteWindow{T}</code></pre><p>Structure with unique field <code>idx</code> representing the index of the vertex of a graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/window.jl#L1-L5">source</a></section></article><h2 id="Hard-core-graph"><a class="docs-heading-anchor" href="#Hard-core-graph">Hard core graph</a><a id="Hard-core-graph-1"></a><a class="docs-heading-anchor-permalink" href="#Hard-core-graph" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.HardCoreGraph" href="#PartialRejectionSampling.HardCoreGraph"><code>PartialRejectionSampling.HardCoreGraph</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">HardCoreGraph{T&lt;:Integer} &lt;: AbstractGraphPointProcess{T}</code></pre><p>Concrete type representing a point process on the vertices of a <code>graph</code> <span>$=(V, E)$</span> parametrized by <span>$\beta \geq 0$</span> which characterizes the distribution on the <a href="https://en.wikipedia.org/wiki/Independent_set_(graph_theory)">independent sets</a> of <code>graph</code>, where each vertex is present with marginal probability <span>$\frac{\beta}{1+\beta}$</span>.</p><p>In other words, it can also be viewed as the product distribution <span>$\operatorname{Bernoulli}(\frac{\beta}{1+\beta})^{\otimes |V|}$</span> on the vertices of <code>graph</code> conditioned on forming an independent set,</p><p class="math-container">\[    \mathbb{P}\!\left[ \mathcal{X} = X \right]
    \propto
    \prod_{x\in X}
        \frac{\beta}{1+\beta}
     1_{X \text{forms an independent set}}.\]</p><p><strong>See also</strong></p><ul><li>Section 7.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>,</li><li>Example 4.1 of <a href="../references/#MoKr20">Sarat B. Moka , Dirk P. Kroese  (2020)</a>,</li><li><a href="../spatial/#PartialRejectionSampling.HardCorePointProcess"><code>PRS.HardCorePointProcess</code></a>, the spatial counterpart of <a href="#PartialRejectionSampling.HardCoreGraph"><code>PRS.HardCoreGraph</code></a>.</li></ul><p><strong>Example</strong></p><p>A realization from a <span>$5\times 5$</span> grid graph, with <span>$\beta = 0.5$</span>.</p><p><img src="../assets/hard_core_graph.png" alt="assets/hard_core_graph.png"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/hard_core.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.HardCoreGraph-Union{Tuple{T}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Real}} where T&lt;:Integer" href="#PartialRejectionSampling.HardCoreGraph-Union{Tuple{T}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Real}} where T&lt;:Integer"><code>PartialRejectionSampling.HardCoreGraph</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">HardCoreGraph(
    graph::LG.SimpleGraph{T},
    β::Real
) where {T&lt;:Integer}</code></pre><p>Construct a <a href="#PartialRejectionSampling.HardCoreGraph"><code>PRS.HardCoreGraph</code></a>.</p><pre><code class="language-julia">using PartialRejectionSampling
using LightGraphs; const LG = LightGraphs

g, β = LG.grid([5, 5]), 1
PRS.HardCoreGraph(g, β)

# output

HardCoreGraph{Int64}
- graph = {25, 40} undirected simple Int64 graph
- β = 1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/hard_core.jl#L38-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample-Union{Tuple{T}, Tuple{Random.AbstractRNG,HardCoreGraph{T}}} where T" href="#PartialRejectionSampling.generate_sample-Union{Tuple{T}, Tuple{Random.AbstractRNG,HardCoreGraph{T}}} where T"><code>PartialRejectionSampling.generate_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample(
    [rng=Random.AbstractRNG,]
    pp::HardCoreGraph{T}
)::Vector{T} where {T}</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.SinkFreeGraph"><code>PRS.SinkFreeGraph</code></a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/hard_core.jl#L70-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,HardCoreGraph{T}}} where T" href="#PartialRejectionSampling.generate_sample_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,HardCoreGraph{T}}} where T"><code>PartialRejectionSampling.generate_sample_prs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_prs(
    [rng=Random.AbstractRNG,]
    pp::HardCoreGraph{T}
)::Vector{T} where {T}</code></pre><p>Sample from <a href="#PartialRejectionSampling.HardCoreGraph"><code>PRS.HardCoreGraph</code></a> using Partial Rejection Sampling (PRS), see Section 7.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a></p><p><strong>See also</strong></p><ul><li>Example 4.1 of <a href="../references/#MoKr20">MoKr20</a>.</li></ul><p><strong>Example</strong></p><p>An illustration of the procedure on a <span>$5\times 5$</span> grid graph.</p><ul><li>red: variables involved in constraints violation (gray neighboring nodes)</li><li>orange: variables to be resampled (red nodes and their neighborhood)</li></ul><p><img src="../assets/hard_core_graph.gif" alt="assets/hard_core_graph.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/hard_core.jl#L91-L111">source</a></section></article><h2 id="Rooted-spanning-forests"><a class="docs-heading-anchor" href="#Rooted-spanning-forests">Rooted spanning forests</a><a id="Rooted-spanning-forests-1"></a><a class="docs-heading-anchor-permalink" href="#Rooted-spanning-forests" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.RootedSpanningForest" href="#PartialRejectionSampling.RootedSpanningForest"><code>PartialRejectionSampling.RootedSpanningForest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RootedSpanningForest{T&lt;:LG.SimpleDiGraph{Int64}} &lt;: AbstractGraphPointProcess{T}</code></pre><p>Concrete type reprensenting a point process defined on the edges of a <strong>connected</strong> <code>graph</code> characterizing the uniform distribution on the directed <a href="https://en.wikipedia.org/wiki/Spanning_tree">spanning forests</a> of <code>graph</code> rooted at <code>roots</code>.</p><p>It can be viewed as a the product distribution of the uniform distribution on the set of neighbors of each vertex conditioned on forming no cycles.</p><p>The object has two fields:</p><ul><li><code>graph::LG.SimpleGraph{Int64}</code></li><li><code>roots::Vector{Int64}</code></li></ul><p><strong>See also</strong></p><ul><li>Section 4.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</li></ul><p><strong>Example</strong></p><p>A realization from a <span>$5\times 5$</span> grid graph with <code>roots=[13]</code>.</p><p><img src="../assets/rooted_spanning_tree.png" alt="assets/rooted_spanning_tree.png"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.RootedSpanningForest-Union{Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T}}, Tuple{T}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Union{Nothing, AbstractSet{T}, AbstractArray{T,1}, T}}} where T&lt;:Int64" href="#PartialRejectionSampling.RootedSpanningForest-Union{Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T}}, Tuple{T}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Union{Nothing, AbstractSet{T}, AbstractArray{T,1}, T}}} where T&lt;:Int64"><code>PartialRejectionSampling.RootedSpanningForest</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">RootedSpanningForest(
    graph::LG.SimpleGraph{T},
    roots::Union{Nothing,T,AbstractVector{T},AbstractSet{T}}=nothing
) where {T&lt;:Int}</code></pre><p>Construct a <a href="#PartialRejectionSampling.RootedSpanningForest"><code>PRS.RootedSpanningForest</code></a> model on a <strong>connected</strong> <code>graph</code>, rooted at <code>roots</code>. If <code>roots === nothing</code>, a random vertex is selected uniformly at random among <code>LG.vertices(g)</code> and considered as <code>roots</code>.</p><pre><code class="language-julia">using PartialRejectionSampling
using LightGraphs; const LG = LightGraphs

g, roots = LG.grid([5, 5]), [1, 2, 3]

rsf = PRS.RootedSpanningForest(g, roots)

# output

RootedSpanningForest{LightGraphs.SimpleGraphs.SimpleDiGraph{Int64}}
- graph = {25, 40} undirected simple Int64 graph
- roots = [1, 2, 3]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L34-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling._generate_sample_rooted_spanning_forest_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,LightGraphs.SimpleGraphs.SimpleGraph{T},Any}} where T" href="#PartialRejectionSampling._generate_sample_rooted_spanning_forest_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,LightGraphs.SimpleGraphs.SimpleGraph{T},Any}} where T"><code>PartialRejectionSampling._generate_sample_rooted_spanning_forest_prs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">_generate_sample_rooted_spanning_forest_prs(
    rng::Random.AbstractRNG,
    graph::LG.SimpleGraph{T},
    roots
)::LG.SimpleDiGraph{T} where {T}</code></pre><p>Generate a rooted spanning forest from a <strong>connected</strong> <code>graph</code> with prescribed <code>roots</code>, uniformly at random among all rooted spanning forests rooted at <code>roots</code>, using Partial Rejection Sampling.</p><p><strong>See also</strong></p><ul><li>Section 4.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L122-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling._generate_sample_rooted_spanning_forest_wilson-Union{Tuple{T}, Tuple{Random.AbstractRNG,LightGraphs.SimpleGraphs.SimpleGraph{T},Any}} where T" href="#PartialRejectionSampling._generate_sample_rooted_spanning_forest_wilson-Union{Tuple{T}, Tuple{Random.AbstractRNG,LightGraphs.SimpleGraphs.SimpleGraph{T},Any}} where T"><code>PartialRejectionSampling._generate_sample_rooted_spanning_forest_wilson</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">_generate_sample_rooted_spanning_forest_wilson(
    [rng::Random.AbstractRNG,]
    graph::LG.SimpleGraph{T},
    roots
)</code></pre><p>Generate a spanning forest of a <strong>connected</strong> <code>graph</code> with prescribed <code>roots</code>, uniformly at random among all rooted spanning forests rooted at <code>roots</code>, using <a href="https://en.wikipedia.org/wiki/Loop-erased_random_walk#Uniform_spanning_tree">Wilson&#39;s algorithm</a>.</p><p><strong>See also</strong></p><ul><li><a href="https://gricad-gitlab.univ-grenoble-alpes.fr/barthesi/RandomForests.jl/-/blob/master/src/random_spanning_tree.jl">RandomForests.jl implementation</a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L163-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.directed_forest_from_successors-Tuple{Any}" href="#PartialRejectionSampling.directed_forest_from_successors-Tuple{Any}"><code>PartialRejectionSampling.directed_forest_from_successors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">directed_forest_from_successors(successors)::LG.SimpleDiGraph</code></pre><p>Return a directed graph of size <code>length(successors)</code> with edges <code>i =&gt; successors[i]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L211-L215">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample-Tuple{Random.AbstractRNG,RootedSpanningForest}" href="#PartialRejectionSampling.generate_sample-Tuple{Random.AbstractRNG,RootedSpanningForest}"><code>PartialRejectionSampling.generate_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample(
    [rng::Random.AbstractRNG,]
    pp::RootedSpanningForest
)</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.RootedSpanningForest"><code>PRS.RootedSpanningForest</code></a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L74-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,RootedSpanningForest{T}}} where T&lt;:LightGraphs.SimpleGraphs.SimpleDiGraph{Int64}" href="#PartialRejectionSampling.generate_sample_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,RootedSpanningForest{T}}} where T&lt;:LightGraphs.SimpleGraphs.SimpleDiGraph{Int64}"><code>PartialRejectionSampling.generate_sample_prs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_prs(
    [rng::Random.AbstractRNG,]
    pp::RootedSpanningForest{T}
)::T where {T&lt;:LG.SimpleDiGraph{Int64}}</code></pre><p>Generate a rooted spanning forest of <code>pp.</code>graph<code>with prescribed</code>pp.roots<code>, uniformly at random among all rooted spanning forests rooted at</code>pp.roots`, using Partial Rejection Sampling (PRS).</p><p><strong>See also</strong></p><ul><li>Section 4.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</li></ul><p><strong>Example</strong></p><p>An illustration of the procedure on a <span>$5\times 5$</span> grid graph, with <code>roots=[13]</code></p><ul><li>red: variables involved in constraints violation (edges forming a cycle)</li><li>orange: variables resampled (edges originating from a red/orange node)</li></ul><p><img src="../assets/rooted_spanning_tree_prs.gif" alt="assets/rooted_spanning_tree_prs.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/rooted_spanning_forest.jl#L93-L112">source</a></section></article><h2 id="Sink-free-graph"><a class="docs-heading-anchor" href="#Sink-free-graph">Sink free graph</a><a id="Sink-free-graph-1"></a><a class="docs-heading-anchor-permalink" href="#Sink-free-graph" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.SinkFreeGraph" href="#PartialRejectionSampling.SinkFreeGraph"><code>PartialRejectionSampling.SinkFreeGraph</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SinkFreeGraph{T&lt;:LG.SimpleDiGraph{Int64}} &lt;: AbstractGraphPointProcess{T}</code></pre><p>Concrete type representing a point process on the edges of a <code>graph</code> characterizing the uniform distribution on the orientations of the edges conditioned on the absence of sinks.</p><p><strong>See also</strong></p><ul><li>Section 4.1 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</li></ul><p><strong>Example</strong></p><p>A realization from a <span>$5\times 5$</span> grid graph</p><p><img src="../assets/sink_free_graph.png" alt="assets/sink_free_graph.png"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/sink_free_graph.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.SinkFreeGraph-Tuple{LightGraphs.SimpleGraphs.SimpleGraph{Int64}}" href="#PartialRejectionSampling.SinkFreeGraph-Tuple{LightGraphs.SimpleGraphs.SimpleGraph{Int64}}"><code>PartialRejectionSampling.SinkFreeGraph</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">SinkFreeGraph(graph::LG.SimpleGraph{T}) where {T&lt;:Int}</code></pre><p>Construct a <a href="#PartialRejectionSampling.SinkFreeGraph"><code>PRS.SinkFreeGraph</code></a>.</p><pre><code class="language-julia">using PartialRejectionSampling
using LightGraphs; const LG = LightGraphs

sfg = PRS.SinkFreeGraph(LG.grid([5, 5]))

# output

SinkFreeGraph{LightGraphs.SimpleGraphs.SimpleDiGraph{Int64}}
- graph = {25, 40} undirected simple Int64 graph</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/sink_free_graph.jl#L25-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample-Tuple{Random.AbstractRNG,SinkFreeGraph}" href="#PartialRejectionSampling.generate_sample-Tuple{Random.AbstractRNG,SinkFreeGraph}"><code>PartialRejectionSampling.generate_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample([rng::Random.AbstractRNG,] pp::SinkFreeGraph)</code></pre><p>Generate an exact sample from the <a href="#PartialRejectionSampling.SinkFreeGraph"><code>PRS.SinkFreeGraph</code></a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_prs"><code>PRS.generate_sample_prs</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/sink_free_graph.jl#L44-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,SinkFreeGraph{T}}} where T" href="#PartialRejectionSampling.generate_sample_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,SinkFreeGraph{T}}} where T"><code>PartialRejectionSampling.generate_sample_prs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_prs(
    [rng::Random.AbstractRNG,]
    pp::SinkFreeGraph{T}
)::T where {T}</code></pre><p>Generate an orientated version of <code>pp.graph</code> uniformly at random among all possible orientations conditioned on the absence of sinks, using Partial Rejection Sampling (PRS).</p><p><strong>See also</strong></p><ul><li>Section 4.1 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</li></ul><p><strong>Example</strong></p><p>A illustration of the procedure on a <span>$5 \times 5$</span> grid grah.</p><ul><li>red: variables involved in constraints violation (orientation of the edges pointing to a sink node)</li><li>orange: variables resampled (orientation of the previous edges)</li></ul><p><img src="../assets/sink_free_graph_prs.gif" alt="assets/sink_free_graph_prs.gif"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/sink_free_graph.jl#L54-L74">source</a></section></article><h2 id="Ising-model"><a class="docs-heading-anchor" href="#Ising-model">Ising model</a><a id="Ising-model-1"></a><a class="docs-heading-anchor-permalink" href="#Ising-model" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.Ising" href="#PartialRejectionSampling.Ising"><code>PartialRejectionSampling.Ising</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Ising{T&lt;:Int} &lt;: AbstractGraphPointProcess{T}</code></pre><p>The <a href="https://en.wikipedia.org/wiki/Ising_model">Ising model</a> characterizes a point process defined on the vertices of a graph <span>$(V, E)$</span> with joint density proportional to</p><p class="math-container">\[    \mathbb{P}\!\left[ \mathcal{X}=X \right]
    \propto
    \prod_{i \in V}
        \exp(h_i x_i)
    \prod_{\{i, j\} \in E}
        \exp(J x_i x_j)\]</p><p>where <span>$(h_i)_{i\in V}$</span> are called magnetization paremeters and <span>$J$</span> the interaction coefficient (<span>$J \gtreqless 0$</span> characterizes ferro/antiferro magnetic interactions).</p><p><strong>Example</strong></p><p>A realization from a <span>$5\times 5$</span> grid graph, with <span>$h = 0.2, J = 0.1$</span>.</p><p><img src="assets/ising.png" alt="assets/ising.png"/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.Ising-Union{Tuple{T}, Tuple{Array{T,1},Real}, Tuple{Array{T,1},Real,Union{Array{Real,1}, Real}}} where T&lt;:Int64" href="#PartialRejectionSampling.Ising-Union{Tuple{T}, Tuple{Array{T,1},Real}, Tuple{Array{T,1},Real,Union{Array{Real,1}, Real}}} where T&lt;:Int64"><code>PartialRejectionSampling.Ising</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Ising(
    dims::Vector{T},
    J::Real,
    h::Union{Real,Vector{Real}}=0;
    periodic::Bool=true
) where {T&lt;:Int}</code></pre><p>Construct <a href="#PartialRejectionSampling.Ising"><code>PRS.Ising</code></a> on a grid graph with dimension <code>dims</code>, interaction parameter <code>J</code> and magnetization <code>h</code>.</p><p>Periodic boundary conditions on the grid graph are set according to <code>periodic</code>.</p><pre><code class="language-julia">using PartialRejectionSampling

dims = [5, 5]
J, h = 0.01, 0
PRS.Ising(dims, J, h; periodic=true)

# output

Ising{Int64}
- graph = {25, 50} undirected simple Int64 graph
- J = 0.01 (interaction)
- h = 0.0 (magnetization)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L35-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.Ising-Union{Tuple{T}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Real}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Real,Union{Array{Real,1}, Real}}} where T&lt;:Int64" href="#PartialRejectionSampling.Ising-Union{Tuple{T}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Real}, Tuple{LightGraphs.SimpleGraphs.SimpleGraph{T},Real,Union{Array{Real,1}, Real}}} where T&lt;:Int64"><code>PartialRejectionSampling.Ising</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Ising(
    graph::LG.SimpleGraph{T},
    J::Real,
    h::Union{Real,Vector{Real}}=0
) where {T&lt;:Int}</code></pre><p>Construct <a href="#PartialRejectionSampling.Ising"><code>PRS.Ising</code></a> on <code>graph</code> with interaction parameter <code>J</code> and magnetization <code>h</code>.</p><pre><code class="language-julia">using PartialRejectionSampling
using LightGraphs; const LG = LightGraphs

graph = LG.grid([5, 5])
J, h = 0.01, 0
PRS.Ising(graph, J, h)

# output

Ising{Int64}
- graph = {25, 40} undirected simple Int64 graph
- J = 0.01 (interaction)
- h = 0.0 (magnetization)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L72-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample!-Union{Tuple{T}, Tuple{Random.AbstractRNG,AbstractArray{T,1},Any,Ising{T}}} where T&lt;:Int64" href="#PartialRejectionSampling.generate_sample!-Union{Tuple{T}, Tuple{Random.AbstractRNG,AbstractArray{T,1},Any,Ising{T}}} where T&lt;:Int64"><code>PartialRejectionSampling.generate_sample!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample!(
    rng::Random.AbstractRNG,
    state::AbstractVector{T},
    indices,
    ising::Ising{T}
) where {T&lt;:Int}</code></pre><p>Generate an exact sample from the marginal distribution of each states of the <a href="#PartialRejectionSampling.Ising"><code>PRS.Ising</code></a> model <code>ising</code> at the prescribed <code>indices</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L162-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T},T}} where T&lt;:Int64" href="#PartialRejectionSampling.generate_sample-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T},T}} where T&lt;:Int64"><code>PartialRejectionSampling.generate_sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample(
    [rng::Random.AbstractRNG,]
    pp::Ising{T},
    idx::T
)::T where {T&lt;:Int}</code></pre><p>Generate an exact sample from the marginal distribution of state <span>$i=$</span> <code>idx</code> of <code>pp</code>.</p><p>More specifically,</p><p class="math-container">\[    x_i
        \sim
        \operatorname{Bernoulli}_{-1, 1}
            (\sigma(h_i)),\]</p><p>where <span>$\sigma$</span> denotes the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid function</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L126-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_conditional!-Union{Tuple{T}, Tuple{Random.AbstractRNG,AbstractArray{T,1},T,Ising{T}}} where T&lt;:Int64" href="#PartialRejectionSampling.generate_sample_conditional!-Union{Tuple{T}, Tuple{Random.AbstractRNG,AbstractArray{T,1},T,Ising{T}}} where T&lt;:Int64"><code>PartialRejectionSampling.generate_sample_conditional!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_conditional!(
    rng::Random.AbstractRNG,
    state::AbstractVector{T},
    i::T,
    ising::Ising{T}
) where {T&lt;:Int}</code></pre><p>Generate an exact sample from the conditional distribution of the state <span>$x_i$</span> given its neighboring states in <code>ising.graph</code>. More specifically,</p><p class="math-container">\[    x_i \mid x_{N(i)}
        \sim
        \operatorname{Bernoulli}_{-1, 1}
            (\sigma(h_i + J \sum_{j \in N(i)} x_j)),

where ``\sigma`` denotes the [sigmoid function](https://en.wikipedia.org/wiki/Sigmoid_function).\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L183-L201">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_prs-Tuple{Random.AbstractRNG,Ising}" href="#PartialRejectionSampling.generate_sample_prs-Tuple{Random.AbstractRNG,Ising}"><code>PartialRejectionSampling.generate_sample_prs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_prs(
    [rng::Random.AbstractRNG,]
    pp::Ising
)</code></pre><p>Generate an exact sample form <code>pp</code> using Partial Rejection Sampling (PRS), see Section 4.2 of <a href="../references/#GuJeLi19">Heng Guo , Mark Jerrum , Jingcheng Liu  (2019)</a>.</p><p>Default sampler is <a href="../sampling/#PartialRejectionSampling.generate_sample_grid_prs-Union{Tuple{T}, Tuple{Random.AbstractRNG,AbstractPointProcess{T}}} where T"><code>PRS.generate_sample_grid_prs</code></a>.</p><p><strong>See also</strong></p><ul><li><a href="../references/#FeViYi19">Weiming Feng , Nisheeth K. Vishnoi , Yitong Yin  (2019)</a>,</li><li><a href="../references/#FeGuYi19">Weiming Feng , Heng Guo , Yitong Yin  (2019)</a> <a href="#PartialRejectionSampling.generate_sample_gibbs_perfect-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T}}} where T&lt;:Int64"><code>PRS.generate_sample_gibbs_perfect</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising.jl#L108-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.bayes_filter-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T},AbstractArray{T,1},T,Set{T}}} where T&lt;:Int64" href="#PartialRejectionSampling.bayes_filter-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T},AbstractArray{T,1},T,Set{T}}} where T&lt;:Int64"><code>PartialRejectionSampling.bayes_filter</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">bayes_filter(
    rng::Random.AbstractRNG,
    ising::Ising{T},
    state::AbstractVector{T},
    i::T,
    R::Set{T}
)::Bool</code></pre><p>This function is used as a subroutine of <a href="#PartialRejectionSampling.generate_sample_gibbs_perfect-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T}}} where T&lt;:Int64"><code>PRS.generate_sample_gibbs_perfect</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising_sampling_gibbs_perfect.jl#L37-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PartialRejectionSampling.generate_sample_gibbs_perfect-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T}}} where T&lt;:Int64" href="#PartialRejectionSampling.generate_sample_gibbs_perfect-Union{Tuple{T}, Tuple{Random.AbstractRNG,Ising{T}}} where T&lt;:Int64"><code>PartialRejectionSampling.generate_sample_gibbs_perfect</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">generate_sample_gibbs_perfect(
    [rng::Random.AbstractRNG,]
    ising::Ising{T}
)::Vector{T} where {T&lt;:Int}</code></pre><p>Generate an exact realization of the <a href="#PartialRejectionSampling.Ising"><code>PRS.Ising</code></a> model using a tailored implementation of the perfect Gibbs sampler of <a href="../references/#FeGuYi19">Weiming Feng , Heng Guo , Yitong Yin  (2019)</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/guilgautier/PartialRejectionSampling.jl/blob/f5d09913a0de55831f66747d3c71a70a35433d80/src/graph/ising_sampling_gibbs_perfect.jl#L2-L9">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sampling/">« Sampling methods</a><a class="docs-footer-nextpage" href="../spatial/">Spatial point processes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 11 March 2021 08:35">Thursday 11 March 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
